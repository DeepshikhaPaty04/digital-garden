---
{"dg-publish":true,"permalink":"/cybersecurity/02-pentesting/d10-04-mar/ssrf/lab-ssrf-with-filter-bypass-via-open-redirection-vulnerability/"}
---

Date : 04 Mar, 2025

---

This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at `http://192.168.0.12:8080/admin` and delete the user `carlos`.

The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.

[ACCESS THE LAB](https://portswigger.net/academy/labs/launch/3bd839053db0960daf7046201a4b58936ba21cbb4a15840db8237690eb2c4be7?referrer=%2fweb-security%2fssrf%2flab-ssrf-filter-bypass-via-open-redirection)

---
### **Motive / Objective**

To demonstrate how an **open redirect can be combined with SSRF** to:
- **Bypass SSRF filters** that prevent direct access to internal hosts.
- **Trick the server into making internal requests indirectly** via trusted-looking URLs.

---

 ###  Solution

1. Visit a product, click "Check stock", intercept the request in Burp Suite, and send it to Burp Repeater.
2. Try tampering with the `stockApi` parameter and observe that it isn't possible to make the server issue the request directly to a different host.
3. Click "next product" and observe that the `path` parameter is placed into the Location header of a redirection response, resulting in an open redirection.
4. Create a URL that exploits the open redirection vulnerability, and redirects to the admin interface, and feed this into the `stockApi` parameter on the stock checker:
    
    `/product/nextProduct?path=http://192.168.0.12:8080/admin`
5. Observe that the stock checker follows the redirection and shows you the admin page.
6. Amend the path to delete the target user:
    
    `/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos`

 