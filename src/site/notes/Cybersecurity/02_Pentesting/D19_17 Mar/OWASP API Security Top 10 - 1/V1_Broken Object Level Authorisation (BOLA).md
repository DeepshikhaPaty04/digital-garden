---
{"dg-publish":true,"permalink":"/cybersecurity/02-pentesting/d19-17-mar/owasp-api-security-top-10-1/v1-broken-object-level-authorisation-bola/"}
---

Deepshikha Paty
DI-ASM

---

[Access the lab](https://tryhackme.com/room/owaspapisecuritytop105w)

---
### **What is BOLA (Broken Object Level Authorization)?**

BOLA happens when an API lets users access data just by changing the object ID in the request â€” **without checking if theyâ€™re authorized to do so**.

### For example:  
If a user changes `/user/1` to `/user/2` in the API link and gets someone elseâ€™s data â€” thatâ€™s BOLA!

### Example 1:
> [!example]
> ### **Filename-Based BOLA Example:**
> 
> - A user accesses their payslip by opening:  
>     `https://company.com/payslips/deepshikha_march2025.pdf`
> - Out of curiosity, they modify the URL to:  
>     `https://company.com/payslips/rahul_march2025.pdf`
> - The system **serves Rahulâ€™s payslip** without checking if the logged-in user is allowed to access it.

> âœ… _Broken object-level authorization: the filename is an object identifier thatâ€™s not access-controlled._

### Example 2:
> [!example]
> ### **Token-Based BOLA Example:**
> 
> - A user resets their password using a recovery link:  
>     `https://example.com/reset-password?token=abc123`
> - They tamper with the token to:  
>     `https://example.com/reset-password?token=def456`
> - If the system doesn't validate whether the token belongs to the currently authenticated user, they might reset **another userâ€™s password**.

>  âœ… _Object is the token, and authorization is missing = BOLA._


### Example 3:

> [!example]
> ### **Invoice/Order Number Format Example:**
> 
> - A logged-in customer accesses their invoice:  
>     `https://shop.com/invoices/INV_2025_A001`
> - They modify the URL to:  
>     `https://shop.com/invoices/INV_2025_A002`
> - If the system doesnâ€™t validate the customerâ€™s ownership of the invoice, they gain access to another personâ€™s invoice.

> âœ… _Object = invoice number, not an ID, but still sensitive._

---
### **ðŸŽ¯ Why is it a problem?**

If thereâ€™s no **security check**, anyone can access private data just by changing the ID in the request.  
This can lead to:

- Personal data leaks
- `Account takeovers`
- Huge damage to a companyâ€™s trust and finances


### **âœ… How to Prevent ?**

1. Always **check if the user is allowed** to access the data.
2. Use **access tokens** to identify who is making the request.
3. Use **random or encrypted IDs** so they canâ€™t be guessed.