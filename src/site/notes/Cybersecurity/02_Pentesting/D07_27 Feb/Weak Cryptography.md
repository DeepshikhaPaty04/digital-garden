---
{"dg-publish":true,"permalink":"/cybersecurity/02-pentesting/d07-27-feb/weak-cryptography/"}
---

- Cryptographic failures which generally occur due to weak cryptography, is one of the OWASP Top 10 vuln.
- Testing for this includes audit of the data at rest in database as well as data in transit between client and server.
- ##### Summary Table

|Technique|Mostly Used For|Purpose|
|---|---|---|
|**Encryption**|Data in transit AND at rest|Protect data from being read|
|**Hashing**|Data at rest (like passwords)|Verify data, not reverse it|
- There are many possible attacks and scenarios that can be possible because of weak cryptography
  - man in the middle attack
  - weak cryptography
  - steal keys
  - clear text data
  - weak algorithm

- ##### **Old & Insecure – Disable These Immediately:**

|Protocol|Status|Why Disable?|
|---|---|---|
|**SSLv2**|Very outdated|Broken encryption, vulnerable to many attacks|
|**SSLv3**|Outdated|Vulnerable to POODLE attack|
|**TLS 1.0**|Weak|Uses outdated ciphers, not PCI compliant|
|**TLS 1.1**|Weak|Not secure by today’s standards|

> ⚠️ These versions are **deprecated** and should be **disabled** on all servers, applications, and services

---
- ##### **Secure & Recommended – Enable Only These:**

|Protocol|Status|Why Use?|
|---|---|---|
|**TLS 1.2**|Strong|Secure and widely supported|
|**TLS 1.3**|Latest & Best|Faster, more secure, removes weak parts|

> TLS 1.2 is still widely used and secure.  
> TLS 1.3 is **the most secure and modern version** — preferred whenever possible.



### **PII - Personal Identifiable Information**
- sensitive information included data such as health records , credentials, personal data , credit cards ,email addr, OTP , aadhar card ,social security number etc.

> [!question]
> 
> **Am I Vulnerable to Data Exposure?**
> The first thing you have to determine is which data issensitive enough to require extra protection. For example,passwords, credit card numbers, health records, and personalinformation should be protected. For all such data:
> 
> 1. Is any of this data stored in clear text long term, includingbackups of this data?
> 2. Is any of this data transmitted in clear text, internally orexternally? Internet traffic is especially dangerous.
> 3. Are any old / weak cryptographic algorithms used?
> 4. Are weak crypto keys generated, or is proper keymanagement or rotation missing?
> 5. Are any browser security directives or headers missing when sensitive data is provided by / sent to the browser? And more … For a more complete set of problems to avoid,see ASVS areas Crypto (V7), Data Prot. (V9), and SSL (V10) 

## Installing Jython

- [Install Guide](https://www.jython.org/download.html)

1. Extensions → Extension Settings
![attachments/Pasted image 20250317110324.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110324.png)

2. Python env → upload the jython jar file
![attachments/Pasted image 20250317110339.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110339.png)

3. burp store → SSL scanner → Install
![attachments/Pasted image 20250317110350.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110350.png)

4. we can load or onload the extensions inside Extension → Extension tab
5. click on SSL Scanner
![attachments/Pasted image 20250317110402.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110402.png)
6. then give the website : https://demo.testfire.net/ for general testing
![attachments/Pasted image 20250317110416.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110416.png)

7. results are as follows:
- from this we realise weak protocols are used like SSL v2, SLLv3...
![attachments/Pasted image 20250317110442.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110442.png)

- here weak cipher are TLSV1.0

----
## **Supported ciphers (by Protocol)**

*TLSv1.0*
- ECDHE-RSA-AES256-SHA: LUCKY13
- DHE-RSA-AES256-SHA: LUCKY13
- ECDHE-RSA-AES128-SHA: LUCKY13
- DHE-RSA-AES128-SHA: LUCKY13
*TLSv1.1*
- ECDHE-RSA-AES256-SHA: LUCKY13
- DHE-RSA-AES256-SHA: LUCKY13
- ECDHE-RSA-AES128-SHA: LUCKY13
- DHE-RSA-AES128-SHA: LUCKY13

- website to check the ciphere whether good or bad : https://ciphersuite.info/

----
### **Using nmap how can we find out some ciphers :**
1. sudo su
| → to enter into root directory
nmap -sn demo.testfire.net
![attachments/Pasted image 20250317110821.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110821.png)

2. nmap -Pn --script ssl-enum-ciphers -p443 demo.testfire.net 
-oN demo.testfire.net
![attachments/Pasted image 20250317110833.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110833.png)

----
- qualys.ssl labs : https://www.ssllabs.com/ssltest/
1. first visit the Qualys lab and use: https://demo.testfire.net/
![attachments/Pasted image 20250317202430.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202430.png)

2. you can see the result, that the website uses weak protocol suites like TLS v1.0.1...
![attachments/Pasted image 20250317202447.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202447.png)

![attachments/Pasted image 20250317202501.png](/img/user/Cybersecurity/02_Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202501.png)

> [!summary]
> From the overall testing for weak cryptography on https://demo.testfire.net/ using different tools we found different cryptographic issues on the target.

