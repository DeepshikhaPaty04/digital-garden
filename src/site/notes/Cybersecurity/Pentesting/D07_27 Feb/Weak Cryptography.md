---
{"dg-publish":true,"permalink":"/cybersecurity/pentesting/d07-27-feb/weak-cryptography/"}
---


- includes audit of the data at rest in database as well as data in transit between client and server.
- encyption : data in transit
- hashing : data in rest
- man in the middle attack
- weak cryptography
- steal keys
- clear text data
- weak algorithm
- sslv2,sllv3,tls,tls v1.0,tls v1.1 -- needs to be disabled tls v1.2 , tls v1.3( recent one).

- PII - personal identifiable information
- sensitive information included data such as health records , credentials, personal data , credit cards ,email addr, OTP , aadhar card ,social security number etc.

- Am I Vulnerable to Data Exposure?
The first thing you have to determine is which data issensitive enough to require extra protection. For example,passwords, credit card numbers, health records, and personalinformation should be protected. For all such data:

1. Is any of this data stored in clear text long term, includingbackups of this data?
2. Is any of this data transmitted in clear text, internally orexternally? Internet traffic is especially dangerous.
3. Are any old / weak cryptographic algorithms used?
4. Are weak crypto keys generated, or is proper keymanagement or rotation missing?
5. Are any browser security directives or headers missing when sensitive data is provided by / sent to the browser? And more … For a more complete set of problems to avoid,see ASVS areas Crypto (V7), Data Prot. (V9), and SSL (V10) 

- install jython: https://www.jython.org/download.html

1. Extensions → Extension Settings
![attachments/Pasted image 20250317110324.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110324.png)

2. Python env → upload the jython jar file
![attachments/Pasted image 20250317110339.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110339.png)

3. burp store → SSL scanner → Install
![attachments/Pasted image 20250317110350.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110350.png)

4. we can load or onload the extensions inside Extension → Extension tab
5. click on SSL Scanner
![attachments/Pasted image 20250317110402.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110402.png)
6. then hit the website : https://demo.testfire.net/
![attachments/Pasted image 20250317110416.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110416.png)

7. results are this.
- from this we realise weak protocols are used like SSL v2, SLLv3...
![attachments/Pasted image 20250317110442.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110442.png)

- here weak cipher are TLSV1.0

----
## **Supported ciphers (by Protocol)**

*TLSv1.0*
- ECDHE-RSA-AES256-SHA: LUCKY13
- DHE-RSA-AES256-SHA: LUCKY13
- ECDHE-RSA-AES128-SHA: LUCKY13
- DHE-RSA-AES128-SHA: LUCKY13
*TLSv1.1*
- ECDHE-RSA-AES256-SHA: LUCKY13
- DHE-RSA-AES256-SHA: LUCKY13
- ECDHE-RSA-AES128-SHA: LUCKY13
- DHE-RSA-AES128-SHA: LUCKY13

- website to check the ciphere whether good or bad : https://ciphersuite.info/

----
### **Using nmap how can we find out some ciphers :**
1. sudo su
| → to enter into root directory
nmap -sn demo.testfire.net
![attachments/Pasted image 20250317110821.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110821.png)

2. nmap -Pn --script ssl-enum-ciphers -p443 demo.testfire.net 
-oN demo.testfire.net
![attachments/Pasted image 20250317110833.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317110833.png)

----
- qualys.ssl labs : https://www.ssllabs.com/ssltest/
1. first visit the website and hit the https://demo.testfire.net/
![attachments/Pasted image 20250317202430.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202430.png)

2. you can see the result, that the website uses weak protocol suites like TLS v1.0.1...
![attachments/Pasted image 20250317202447.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202447.png)

![attachments/Pasted image 20250317202501.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202501.png)

---
## Lab-4

1. now git clone the website : git clone this https://github.com/testssl/testssl.sh.git
2. cd testssl.sh
3. ./testssl.sh -U https://demo.testfire.net
or
./testssl.sh -U demo.testfire.net :443
4. the result is this
![attachments/Pasted image 20250317202645.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202645.png)

![attachments/Pasted image 20250317202701.png](/img/user/Cybersecurity/Pentesting/D07_27%20Feb/attachments/Pasted%20image%2020250317202701.png)


#                                    ---****---
